import requests
import config
import random


def get_sentence():
    fallback_sentences = [
        "你问我是不是有病，我太开心了，你开始关心我的健康了。",
        "今天你发朋友圈说‘无聊死了’，我赶紧秒回“我来了”，结果你秒删了朋友圈。原来你是在等别人，不是我。",
        "你说‘你怎么又来了’，我顿时心花怒放，这说明我来得够频繁，你已经记住我了。",
        "你在群里发了个“谁能帮我点一下”，我兴奋得像被点了名的学生，直到我看到@的不是我。",
        "你今天终于给我发了消息：“我手机落出租车了，能不能借你身份证挂个失物？”我连身份证正反面和户口本都拍给你了。",
        "你问我：“你这么舔我有意思吗？”我一愣，原来你知道我在舔你，我不是个背景板，我是个舔狗！",
        "有一次你问我“你是不是暗恋我？”我说不是，其实我想说的是我不是暗恋，是明恋，是光明正大无条件热烈的爱。",
        "今天我试着不找你，结果你一天都没理我，证明你已经习惯我找你了。我太感动了，原来我已经变得不重要到你不会察觉我不在。",
        "你发了一张自拍配文‘谁来抱抱我’，我评论：“我！我！我！”结果你点赞了我哥的评论。",
        "你发微博说想吃火锅，我立刻发了100块红包给你，你回了句‘谢谢’，然后我看到你在另一个男人发的评论下说‘宝贝走呀’。",
        "你朋友圈发了“想被爱”，我以为在说我，结果第二天你和别人官宣了。",
        "你从来不回我消息，但我一点都不难过，可能你的手机太烫了，不舍得碰我发过去的温度。",
        "你说你谈恋爱了，我说恭喜，真的，恭喜你终于脱单了，也恭喜我，终于可以不用每天伪装得若无其事地喜欢你了。",
        "你和我说你失恋了，我陪你聊到凌晨三点，第二天你说“谢谢你，真的好哥们。”我乐了，我终于升级成“哥们”了。",
        "我不是舔狗，我只是刚好喜欢的人不喜欢我而已。",
        "你说你想要一份稳定的感情，我说我可以，你说：“不是你。”那一刻我明白了，稳定的不是感情，是我在原地等你。",
        "你让我别再找你了，我笑了笑删了对话框，然后固定了你的星标联系人，设为了特别关心。"
    ]

    try:
        url = config.FUNNY_SENTENCE_URRL
        response = requests.get(url, timeout=5)
        response.raise_for_status()
        data = response.json()

        # 如果data结构异常，则fallback
        if "data" in data and isinstance(data["data"], str):
            return data["data"]
        else:
            raise ValueError("返回数据结构异常")

    except Exception as e:
        # 日志可选：print(f"获取每日一句失败：{e}")
        return random.choice(fallback_sentences)
